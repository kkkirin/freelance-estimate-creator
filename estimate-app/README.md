# è¦‹ç©ã‚‚ã‚Šä½œæˆã‚¢ãƒ—ãƒª v1.0.0

ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹æ˜ åƒåˆ¶ä½œè€…å‘ã‘ã®è¦‹ç©ã‚‚ã‚Šä½œæˆãƒ»å…±æœ‰ã‚¢ãƒ—ãƒªã§ã™ã€‚

## ğŸ¥ ãƒ‡ãƒ¢ãƒ»ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

> **æ³¨æ„**: ã“ã®ã‚¢ãƒ—ãƒªã‚’å®Ÿéš›ã«è©¦ã™å ´åˆã¯ã€é©åˆ‡ãªSupabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå¿…è¦ã§ã™ã€‚

## æ©Ÿèƒ½

### ğŸ¯ ã‚³ã‚¢æ©Ÿèƒ½
- **è¦‹ç©ã‚‚ã‚Šä½œæˆ**: ä½œæ¥­é …ç›®ãƒ»æ™‚é–“ãƒ»å˜ä¾¡ã‚’å…¥åŠ›ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é‡‘é¡è¨ˆç®—
- **å…±æœ‰URL**: è¦‹ç©ã‚‚ã‚Šã‚’å›ºæœ‰URLã§ç°¡å˜å…±æœ‰
- **Revision Policy**: ä¿®æ­£å›æ•°ä¸Šé™ã¨è¿½åŠ è²»ç”¨ã‚’äº‹å‰æ˜ç¤º
- **ä¿®æ­£å›æ•°ç®¡ç†**: ä½¿ç”¨æ¸ˆã¿ä¿®æ­£å›æ•°ã‚’ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§è¿½è·¡

### ğŸ› ï¸ ç®¡ç†æ©Ÿèƒ½
- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†**: MVãƒ»CMãƒ»ä¼æ¥­VPãªã©ã®åˆ¶ä½œã‚¿ã‚¤ãƒ—åˆ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- **èªè¨¼ã‚·ã‚¹ãƒ†ãƒ **: Magic Link ã«ã‚ˆã‚‹å®‰å…¨ã§ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ­ã‚°ã‚¤ãƒ³
- **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: å…¨è¦‹ç©ã‚‚ã‚Šã®ä¸€è¦§ç®¡ç†

### ğŸ“± ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: PCãƒ»ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œ
- **PDFå‡ºåŠ›**: å…±æœ‰ãƒšãƒ¼ã‚¸ã‹ã‚‰ç›´æ¥PDFä¿å­˜å¯èƒ½
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—**: å…¥åŠ›ã¨åŒæ™‚ã«é‡‘é¡æ›´æ–°

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Frontend**: Next.js 15 + TypeScript + Tailwind CSS
- **Backend**: Supabase (PostgreSQL + Auth + RLS)
- **Deploy**: Vercelå¯¾å¿œ
- **èªè¨¼**: Magic Link (Supabase Auth)

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Node.js 18ä»¥ä¸Š
- npm ã¾ãŸã¯ yarn
- Supabaseã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### 2. Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š

1. [Supabase](https://supabase.com)ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
2. SQL Editorã§ `supabase/migrations/001_initial_schema.sql` ã‚’å®Ÿè¡Œ
   - ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆMVã€CMã€ä¼æ¥­VPï¼‰ãŒè‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®URLãƒ»API keyã‚’å–å¾—

### 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°:

```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
```

### 4. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```

http://localhost:3001 ã§ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ 

```
users
â”œâ”€â”€ id (UUID, Primary Key)
â”œâ”€â”€ email (Text, Unique)
â”œâ”€â”€ created_at (Timestamp)
â””â”€â”€ updated_at (Timestamp)

templates
â”œâ”€â”€ id (UUID, Primary Key)
â”œâ”€â”€ user_id (UUID, Foreign Key)
â”œâ”€â”€ name (Text)
â”œâ”€â”€ default_hourly_rate (Integer)
â”œâ”€â”€ default_revision_limit (Integer)
â”œâ”€â”€ default_extra_revision_rate (Integer)
â”œâ”€â”€ created_at (Timestamp)
â””â”€â”€ updated_at (Timestamp)

estimates
â”œâ”€â”€ id (UUID, Primary Key)
â”œâ”€â”€ user_id (UUID, Foreign Key)
â”œâ”€â”€ template_id (UUID, Foreign Key, Nullable)
â”œâ”€â”€ title (Text)
â”œâ”€â”€ subtotal (Integer)
â”œâ”€â”€ total (Integer)
â”œâ”€â”€ revision_limit (Integer)
â”œâ”€â”€ extra_revision_rate (Integer)
â”œâ”€â”€ revisions_used (Integer)
â”œâ”€â”€ share_token (Text, Unique)
â”œâ”€â”€ created_at (Timestamp)
â””â”€â”€ updated_at (Timestamp)

line_items
â”œâ”€â”€ id (UUID, Primary Key)
â”œâ”€â”€ estimate_id (UUID, Foreign Key)
â”œâ”€â”€ name (Text)
â”œâ”€â”€ hours (Decimal)
â”œâ”€â”€ hourly_rate (Integer)
â”œâ”€â”€ memo (Text, Nullable)
â”œâ”€â”€ amount (Integer)
â”œâ”€â”€ order_index (Integer)
â”œâ”€â”€ created_at (Timestamp)
â””â”€â”€ updated_at (Timestamp)

revision_logs
â”œâ”€â”€ id (UUID, Primary Key)
â”œâ”€â”€ estimate_id (UUID, Foreign Key)
â”œâ”€â”€ used_number (Integer)
â”œâ”€â”€ memo (Text, Nullable)
â””â”€â”€ created_at (Timestamp)
```

## ä½¿ç”¨æ–¹æ³•

### 1. ãƒ­ã‚°ã‚¤ãƒ³
1. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›
2. é€ä¿¡ã•ã‚ŒãŸMagic Linkã‚’ã‚¯ãƒªãƒƒã‚¯

### 2. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ
1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. åˆ¶ä½œã‚¿ã‚¤ãƒ—ï¼ˆMVãƒ»CMãƒ»ä¼æ¥­VPãªã©ï¼‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ç™»éŒ²

### 3. è¦‹ç©ã‚‚ã‚Šä½œæˆ
1. ã€Œæ–°ã—ã„è¦‹ç©ã‚‚ã‚Šã‚’ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠï¼ˆä»»æ„ï¼‰
3. ä½œæ¥­é …ç›®ãƒ»æ™‚é–“ãƒ»å˜ä¾¡ã‚’å…¥åŠ›
4. Revision Policyã‚’è¨­å®š

### 4. è¦‹ç©ã‚‚ã‚Šå…±æœ‰
1. ä½œæˆå®Œäº†æ™‚ã«ç”Ÿæˆã•ã‚Œã‚‹å…±æœ‰URLã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€ä¿¡
2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ã§é–²è¦§ãƒ»PDFä¿å­˜å¯èƒ½

### 5. ä¿®æ­£å›æ•°ç®¡ç†
1. è¦‹ç©ã‚‚ã‚Šç·¨é›†ç”»é¢ã§ã€Œä¿®æ­£å›æ•°ã‚’æ¶ˆåŒ–ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. æ®‹ã‚Šå›æ•°ãŒè‡ªå‹•æ›´æ–°
3. ä¸Šé™åˆ°é”æ™‚ã¯è¿½åŠ è²»ç”¨è¡¨ç¤º

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **Row Level Security**: Supabase RLSã§ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **å…±æœ‰URL**: æ¨æ¸¬å›°é›£ãª12æ–‡å­—ä»¥ä¸Šã®ãƒ©ãƒ³ãƒ€ãƒ ãƒˆãƒ¼ã‚¯ãƒ³
- **èªè¨¼**: Magic Linkã«ã‚ˆã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¬ã‚¹èªè¨¼

## ãƒ‡ãƒ—ãƒ­ã‚¤

### Vercel (æ¨å¥¨)

1. GitHubãƒªãƒã‚¸ãƒˆãƒªã«ãƒ—ãƒƒã‚·ãƒ¥
2. Vercelã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
3. ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
4. ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ

### ãã®ä»–ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æ¨™æº–çš„ãªNext.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãªã®ã§ã€Netlifyã€Railwayã€Dockerãªã©æ§˜ã€…ãªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ã§ã™ã€‚

## ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

- [ ] PDFå‡ºåŠ›æ©Ÿèƒ½ã®æ”¹å–„
- [ ] Notion APIé€£æº
- [ ] Google Drive APIé€£æº
- [ ] è«‹æ±‚æ›¸æ©Ÿèƒ½
- [ ] å¤šé€šè²¨å¯¾å¿œ
- [ ] ãƒãƒ¼ãƒ æ©Ÿèƒ½

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

**å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚¨ãƒ©ãƒ¼ï¼ˆforeign key constraint violatesï¼‰**
```
ERROR: insert or update on table "templates" violates foreign key constraint
```

**è§£æ±ºæ–¹æ³•**: 
æœ€æ–°ã® `supabase/migrations/001_initial_schema.sql` ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆsystem_templatesï¼‰ã§ç®¡ç†ã—ã€å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®å•é¡Œã‚’å›é¿ã—ã¦ã„ã¾ã™ã€‚

**ç’°å¢ƒå¤‰æ•°ã‚¨ãƒ©ãƒ¼**
```
TypeError: Invalid URL
```

**è§£æ±ºæ–¹æ³•**: 
`.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã«æ­£ã—ã„Supabase URLã¨APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

**ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼**
ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰æ™‚ã¯ `next.config.js` ã§å‹ãƒã‚§ãƒƒã‚¯ã¨ESLintã‚’ç„¡åŠ¹åŒ–ã—ã¦ã„ã‚‹ãŸã‚ã€é–‹ç™ºæ™‚ã«å‹ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹å ´åˆã¯ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ã‚µãƒãƒ¼ãƒˆ

è³ªå•ã‚„ãƒã‚°å ±å‘Šã¯ GitHub Issues ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚
